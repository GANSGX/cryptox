
> @cryptox/server@0.1.0 test C:\Projects\cryptox\server
> vitest run


[1m[46m RUN [49m[22m [36mv4.0.12 [39m[90mC:/Projects/cryptox/server[39m

[90mstdout[2m | src/test/unit/services/user.service.test.ts
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: ðŸ”‘ add access controls to secrets: https://dotenvx.com/ops

[90mstdout[2m | src/test/unit/services/jwt.service.test.ts
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: âš™ï¸  enable debug logging with { debug: true }

[90mstdout[2m | src/test/unit/services/user.service.test.ts[2m > [22m[2mUserService[2m > [22m[2musernameExists()[2m > [22m[2mshould return false for non-existent username
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/unit/services/jwt.service.test.ts[2m > [22m[2mJwtService[2m > [22m[2mgenerate()[2m > [22m[2mshould generate valid JWT token
[22m[39m{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}

[90mstdout[2m | src/test/unit/services/jwt.service.test.ts[2m > [22m[2mJwtService[2m > [22m[2mgenerate()[2m > [22m[2mshould include username and email in token
[22m[39m{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}

[90mstdout[2m | src/test/unit/services/jwt.service.test.ts[2m > [22m[2mJwtService[2m > [22m[2mgenerate()[2m > [22m[2mshould include jti (unique ID) in token
[22m[39m{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}
{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}

[90mstdout[2m | src/test/unit/services/jwt.service.test.ts[2m > [22m[2mJwtService[2m > [22m[2mgenerate()[2m > [22m[2mshould generate different tokens for same payload
[22m[39m{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}
{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}

[90mstdout[2m | src/test/unit/services/jwt.service.test.ts[2m > [22m[2mJwtService[2m > [22m[2mgenerate()[2m > [22m[2mshould include expiration time (exp)
[22m[39m{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}

[90mstdout[2m | src/test/unit/services/jwt.service.test.ts[2m > [22m[2mJwtService[2m > [22m[2mgenerate()[2m > [22m[2mshould include issued at time (iat)
[22m[39m{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}

[90mstdout[2m | src/test/unit/services/jwt.service.test.ts[2m > [22m[2mJwtService[2m > [22m[2mverify()[2m > [22m[2mshould verify valid token
[22m[39m{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}
{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}

[90mstdout[2m | src/test/unit/services/jwt.service.test.ts[2m > [22m[2mJwtService[2m > [22m[2mverify()[2m > [22m[2mshould return null for invalid token
[22m[39m{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}
{"level":"warn","message":"JWT verify: Invalid token header","timestamp":"2025-12-07 12:27:30"}

[90mstdout[2m | src/test/unit/services/jwt.service.test.ts[2m > [22m[2mJwtService[2m > [22m[2mverify()[2m > [22m[2mshould return null for malformed token
[22m[39m{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}
{"level":"warn","message":"JWT verify: Token must have 3 parts","timestamp":"2025-12-07 12:27:30"}

[90mstdout[2m | src/test/unit/services/jwt.service.test.ts[2m > [22m[2mJwtService[2m > [22m[2mverify()[2m > [22m[2mshould return null for tampered token
[22m[39m{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}
{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}
{"error":"invalid signature","level":"warn","message":"JWT verify: Invalid token","timestamp":"2025-12-07 12:27:30"}

[90mstdout[2m | src/test/unit/services/jwt.service.test.ts[2m > [22m[2mJwtService[2m > [22m[2mverify()[2m > [22m[2mshould return null for empty token
[22m[39m{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}
{"level":"warn","message":"JWT verify: Invalid token format","timestamp":"2025-12-07 12:27:30"}

[90mstdout[2m | src/test/unit/services/jwt.service.test.ts[2m > [22m[2mJwtService[2m > [22m[2mdecode()[2m > [22m[2mshould decode valid token without verification
[22m[39m{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}

[90mstdout[2m | src/test/unit/services/jwt.service.test.ts[2m > [22m[2mJwtService[2m > [22m[2mdecode()[2m > [22m[2mshould decode expired token (without verification)
[22m[39m{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}

[90mstdout[2m | src/test/unit/services/jwt.service.test.ts[2m > [22m[2mJwtService[2m > [22m[2mSecurity[2m > [22m[2mshould not include sensitive data in payload
[22m[39m{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}

[90mstdout[2m | src/test/unit/services/jwt.service.test.ts[2m > [22m[2mJwtService[2m > [22m[2mSecurity[2m > [22m[2mshould sign tokens with secret
[22m[39m{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}
{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}

[90mstdout[2m | src/test/unit/services/jwt.service.test.ts[2m > [22m[2mJwtService[2m > [22m[2mSecurity[2m > [22m[2mshould handle very long usernames
[22m[39m{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}

[90mstdout[2m | src/test/unit/services/jwt.service.test.ts[2m > [22m[2mJwtService[2m > [22m[2mSecurity[2m > [22m[2mshould handle unicode characters in username
[22m[39m{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:30"}

 [32mâœ“[39m src/test/unit/services/jwt.service.test.ts [2m([22m[2m19 tests[22m[2m)[22m[32m 136[2mms[22m[39m
[90mstdout[2m | src/test/security/dos-redis-disclosure-extreme.test.ts
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: ðŸ”‘ add access controls to secrets: https://dotenvx.com/ops

[90mstdout[2m | src/test/security/crypto-database-extreme.test.ts
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: ðŸ” prevent committing .env to code: https://dotenvx.com/precommit

[90mstdout[2m | src/test/security/api-websocket-injection-extreme.test.ts
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: ðŸ” encrypt with Dotenvx: https://dotenvx.com

[90mstdout[2m | src/test/integration/auth.test.ts
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: âš™ï¸  suppress all logs with { quiet: true }

[90mstdout[2m | src/test/fuzzing/auth-fuzzing.test.ts
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: âš™ï¸  enable debug logging with { debug: true }

[90mstdout[2m | src/test/security/auth-extreme.test.ts
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: ðŸ” prevent building .env in docker: https://dotenvx.com/prebuild

[90mstdout[2m | src/test/integration/auth.advanced.test.ts
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: ðŸ”‘ add access controls to secrets: https://dotenvx.com/ops

 [32mâœ“[39m src/utils/crypto.test.ts [2m([22m[2m32 tests[22m[2m)[22m[33m 1155[2mms[22m[39m
     [33m[2mâœ“[22m[39m should produce same hash for same password + salt [33m 302[2mms[22m[39m
     [33m[2mâœ“[22m[39m should produce different hashes for different salts [33m 330[2mms[22m[39m
[90mstdout[2m | src/test/integration/auth.test.ts
[22m[39m{"level":"info","message":"âœ… Connected to Redis","timestamp":"2025-12-07 12:27:31"}

[90mstdout[2m | src/test/security/crypto-database-extreme.test.ts
[22m[39m{"level":"info","message":"âœ… Connected to Redis","timestamp":"2025-12-07 12:27:31"}

[90mstdout[2m | src/test/security/api-websocket-injection-extreme.test.ts
[22m[39m{"level":"info","message":"âœ… Connected to Redis","timestamp":"2025-12-07 12:27:31"}

[90mstdout[2m | src/test/security/dos-redis-disclosure-extreme.test.ts
[22m[39m{"level":"info","message":"âœ… Connected to Redis","timestamp":"2025-12-07 12:27:31"}

[90mstdout[2m | src/test/integration/auth.advanced.test.ts
[22m[39m{"level":"info","message":"âœ… Connected to Redis","timestamp":"2025-12-07 12:27:31"}

[90mstdout[2m | src/test/security/auth-extreme.test.ts
[22m[39m{"level":"info","message":"âœ… Connected to Redis","timestamp":"2025-12-07 12:27:31"}

[90mstdout[2m | src/test/fuzzing/auth-fuzzing.test.ts
[22m[39m{"level":"info","message":"âœ… Connected to Redis","timestamp":"2025-12-07 12:27:31"}

[90mstdout[2m | src/test/security/auth-extreme.test.ts
[22m[39m{"level":"info","message":"âœ… Redis is ready","timestamp":"2025-12-07 12:27:31"}

[90mstdout[2m | src/test/security/crypto-database-extreme.test.ts
[22m[39m{"level":"info","message":"âœ… Redis is ready","timestamp":"2025-12-07 12:27:31"}

[90mstdout[2m | src/test/integration/auth.test.ts
[22m[39m{"level":"info","message":"âœ… Redis is ready","timestamp":"2025-12-07 12:27:31"}

[90mstdout[2m | src/test/integration/auth.advanced.test.ts
[22m[39m{"level":"info","message":"âœ… Redis is ready","timestamp":"2025-12-07 12:27:31"}

[90mstdout[2m | src/test/security/api-websocket-injection-extreme.test.ts
[22m[39m{"level":"info","message":"âœ… Redis is ready","timestamp":"2025-12-07 12:27:31"}

[90mstdout[2m | src/test/security/dos-redis-disclosure-extreme.test.ts
[22m[39m{"level":"info","message":"âœ… Redis is ready","timestamp":"2025-12-07 12:27:31"}

[90mstdout[2m | src/test/fuzzing/auth-fuzzing.test.ts
[22m[39m{"level":"info","message":"âœ… Redis is ready","timestamp":"2025-12-07 12:27:31"}

(node:18924) [FSTDEP022] FastifyWarning: The router options for ignoreTrailingSlash property access is deprecated. Please use "options.routerOptions" instead for accessing router options. The router options will be removed in `fastify@6`.
(Use `node --trace-warnings ...` to show where the warning was created)
(node:20932) [FSTDEP022] FastifyWarning: The router options for ignoreTrailingSlash property access is deprecated. Please use "options.routerOptions" instead for accessing router options. The router options will be removed in `fastify@6`.
(Use `node --trace-warnings ...` to show where the warning was created)
(node:5908) [FSTDEP022] FastifyWarning: The router options for ignoreTrailingSlash property access is deprecated. Please use "options.routerOptions" instead for accessing router options. The router options will be removed in `fastify@6`.
(Use `node --trace-warnings ...` to show where the warning was created)
(node:20104) [FSTDEP022] FastifyWarning: The router options for ignoreTrailingSlash property access is deprecated. Please use "options.routerOptions" instead for accessing router options. The router options will be removed in `fastify@6`.
(Use `node --trace-warnings ...` to show where the warning was created)
(node:5912) [FSTDEP022] FastifyWarning: The router options for ignoreTrailingSlash property access is deprecated. Please use "options.routerOptions" instead for accessing router options. The router options will be removed in `fastify@6`.
(Use `node --trace-warnings ...` to show where the warning was created)
(node:12996) [FSTDEP022] FastifyWarning: The router options for ignoreTrailingSlash property access is deprecated. Please use "options.routerOptions" instead for accessing router options. The router options will be removed in `fastify@6`.
(Use `node --trace-warnings ...` to show where the warning was created)
(node:13460) [FSTDEP022] FastifyWarning: The router options for ignoreTrailingSlash property access is deprecated. Please use "options.routerOptions" instead for accessing router options. The router options will be removed in `fastify@6`.
(Use `node --trace-warnings ...` to show where the warning was created)
(node:12996) [FSTDEP022] FastifyWarning: The router options for ignoreTrailingSlash property access is deprecated. Please use "options.routerOptions" instead for accessing router options. The router options will be removed in `fastify@6`.
[90mstdout[2m | src/test/fuzzing/auth-fuzzing.test.ts[2m > [22m[2mAuth Fuzzing Tests[2m > [22m[2mRegistration Fuzzing[2m > [22m[2mshould handle random binary data
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/security/dos-redis-disclosure-extreme.test.ts[2m > [22m[2mðŸ”¥ EXTREME: DoS & Resource Exhaustion[2m > [22m[2mReDoS (Regular Expression DoS)[2m > [22m[2mshould have timeout for regex operations
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/security/auth-extreme.test.ts[2m > [22m[2mðŸ”¥ EXTREME: Authentication & Session Security[2m > [22m[2mJWT Manipulation & Bypass[2m > [22m[2mshould reject JWT with 'none' algorithm (CVE-2015-9235)
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/integration/auth.test.ts[2m > [22m[2mAuth API - Integration & Security Tests[2m > [22m[2mPOST /api/auth/register - Registration[2m > [22m[2mshould register new user with valid data
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/security/crypto-database-extreme.test.ts[2m > [22m[2mðŸ”¥ EXTREME: Cryptography Security[2m > [22m[2mArgon2id Timing Attacks[2m > [22m[2mshould have consistent timing for password verification (prevent timing attacks)
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/integration/auth.advanced.test.ts[2m > [22m[2mAuth Advanced Security Tests[2m > [22m[2mDevice Approval Workflow[2m > [22m[2mshould create pending approval on first login from new device
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/security/api-websocket-injection-extreme.test.ts[2m > [22m[2mðŸ”¥ EXTREME: API Security[2m > [22m[2mMass Assignment Vulnerability[2m > [22m[2mshould prevent mass assignment of protected fields
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/security/auth-extreme.test.ts[2m > [22m[2mðŸ”¥ EXTREME: Authentication & Session Security[2m > [22m[2mJWT Manipulation & Bypass[2m > [22m[2mshould reject JWT with 'none' algorithm (CVE-2015-9235)
[22m[39m{"level":"warn","message":"JWT_SECRET appears to be weak - please use a strong random secret","timestamp":"2025-12-07 12:27:40"}
{"level":"error","message":"JWT verify: \"none\" algorithm rejected","timestamp":"2025-12-07 12:27:40"}

[90mstdout[2m | src/test/security/crypto-database-extreme.test.ts[2m > [22m[2mðŸ”¥ EXTREME: Cryptography Security[2m > [22m[2mArgon2id Timing Attacks[2m > [22m[2mshould use sufficient Argon2 parameters (prevent brute force)
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/integration/auth.advanced.test.ts[2m > [22m[2mAuth Advanced Security Tests[2m > [22m[2mDevice Approval Workflow[2m > [22m[2mshould require approval from trusted device
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/security/api-websocket-injection-extreme.test.ts[2m > [22m[2mðŸ”¥ EXTREME: API Security[2m > [22m[2mMass Assignment Vulnerability[2m > [22m[2mshould whitelist only allowed fields in API requests
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/unit/services/user.service.test.ts[2m > [22m[2mUserService[2m > [22m[2musernameExists()[2m > [22m[2mshould be case-insensitive
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/security/dos-redis-disclosure-extreme.test.ts[2m > [22m[2mðŸ”¥ EXTREME: DoS & Resource Exhaustion[2m > [22m[2mMemory Exhaustion[2m > [22m[2mshould reject extremely large payloads
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/fuzzing/auth-fuzzing.test.ts[2m > [22m[2mAuth Fuzzing Tests[2m > [22m[2mRegistration Fuzzing[2m > [22m[2mshould handle Unicode edge cases
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/security/auth-extreme.test.ts[2m > [22m[2mðŸ”¥ EXTREME: Authentication & Session Security[2m > [22m[2mJWT Manipulation & Bypass[2m > [22m[2mshould reject JWT with tampered payload
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/integration/auth.test.ts[2m > [22m[2mAuth API - Integration & Security Tests[2m > [22m[2mPOST /api/auth/register - Registration[2m > [22m[2mshould store auth_token in database (not plaintext password)
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/security/dos-redis-disclosure-extreme.test.ts[2m > [22m[2mðŸ”¥ EXTREME: DoS & Resource Exhaustion[2m > [22m[2mMemory Exhaustion[2m > [22m[2mshould handle deeply nested JSON
[22m[39mâœ… Connected to PostgreSQL

[90mstderr[2m | src/test/fuzzing/auth-fuzzing.test.ts[2m > [22m[2mAuth Fuzzing Tests[2m > [22m[2mRegistration Fuzzing[2m > [22m[2mshould handle circular JSON references
[22m[39mWarning: Failed to truncate groups: deadlock detected

[90mstdout[2m | src/test/fuzzing/auth-fuzzing.test.ts[2m > [22m[2mAuth Fuzzing Tests[2m > [22m[2mRegistration Fuzzing[2m > [22m[2mshould handle circular JSON references
[22m[39mâœ… Connected to PostgreSQL

[90mstderr[2m | src/test/integration/auth.advanced.test.ts[2m > [22m[2mAuth Advanced Security Tests[2m > [22m[2mSession Management[2m > [22m[2mshould create session on successful login
[22m[39mWarning: Failed to truncate groups: deadlock detected

[90mstdout[2m | src/test/integration/auth.advanced.test.ts[2m > [22m[2mAuth Advanced Security Tests[2m > [22m[2mSession Management[2m > [22m[2mshould create session on successful login
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/security/api-websocket-injection-extreme.test.ts[2m > [22m[2mðŸ”¥ EXTREME: API Security[2m > [22m[2mParameter Pollution[2m > [22m[2mshould reject conflicting parameters
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/unit/services/user.service.test.ts[2m > [22m[2mUserService[2m > [22m[2memailExists()[2m > [22m[2mshould return false for non-existent email
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/fuzzing/auth-fuzzing.test.ts[2m > [22m[2mAuth Fuzzing Tests[2m > [22m[2mRegistration Fuzzing[2m > [22m[2mshould handle special JavaScript values
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/integration/auth.test.ts[2m > [22m[2mAuth API - Integration & Security Tests[2m > [22m[2mPOST /api/auth/register - Registration[2m > [22m[2mshould reject missing fields
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/integration/auth.advanced.test.ts[2m > [22m[2mAuth Advanced Security Tests[2m > [22m[2mRace Conditions & Concurrency[2m > [22m[2mshould handle concurrent logins from same user
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/security/crypto-database-extreme.test.ts[2m > [22m[2mðŸ”¥ EXTREME: Cryptography Security[2m > [22m[2mKey Management & Storage[2m > [22m[2mshould never expose encryption keys in API responses
[22m[39mâœ… Connected to PostgreSQL

(node:20932) [FSTDEP022] FastifyWarning: The router options for ignoreTrailingSlash property access is deprecated. Please use "options.routerOptions" instead for accessing router options. The router options will be removed in `fastify@6`.
(node:20932) [FSTDEP022] FastifyWarning: The router options for ignoreTrailingSlash property access is deprecated. Please use "options.routerOptions" instead for accessing router options. The router options will be removed in `fastify@6`.
[90mstdout[2m | src/test/security/auth-extreme.test.ts[2m > [22m[2mðŸ”¥ EXTREME: Authentication & Session Security[2m > [22m[2mSession Hijacking & Fixation[2m > [22m[2mshould invalidate token if user is deleted
[22m[39mâœ… Connected to PostgreSQL

(node:13460) [FSTDEP022] FastifyWarning: The router options for ignoreTrailingSlash property access is deprecated. Please use "options.routerOptions" instead for accessing router options. The router options will be removed in `fastify@6`.
(node:12996) [FSTDEP022] FastifyWarning: The router options for ignoreTrailingSlash property access is deprecated. Please use "options.routerOptions" instead for accessing router options. The router options will be removed in `fastify@6`.
[90mstderr[2m | src/test/fuzzing/auth-fuzzing.test.ts[2m > [22m[2mAuth Fuzzing Tests[2m > [22m[2mLogin Fuzzing[2m > [22m[2mshould handle control characters in credentials
[22m[39mWarning: Failed to truncate groups: deadlock detected

[90mstdout[2m | src/test/fuzzing/auth-fuzzing.test.ts[2m > [22m[2mAuth Fuzzing Tests[2m > [22m[2mLogin Fuzzing[2m > [22m[2mshould handle control characters in credentials
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/security/api-websocket-injection-extreme.test.ts[2m > [22m[2mðŸ”¥ EXTREME: XSS (Cross-Site Scripting)[2m > [22m[2mReflected XSS[2m > [22m[2mshould sanitize XSS in search queries
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/unit/services/user.service.test.ts[2m > [22m[2mUserService[2m > [22m[2mcreateUser()[2m > [22m[2mshould normalize email to lowercase
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/security/dos-redis-disclosure-extreme.test.ts[2m > [22m[2mðŸ”¥ EXTREME: Information Disclosure[2m > [22m[2mVersion Disclosure[2m > [22m[2mshould not expose server version in headers
[22m[39mâœ… Connected to PostgreSQL

[90mstdout[2m | src/test/fuzzing/auth-fuzzing.test.ts[2m > [22m[2mAuth Fuzzing Tests[2m > [22m[2mLogin Fuzzing[2m > [22m[2mshould handle very long credentials (memory exhaustion attempt)
[22m[39mâœ… Connected to PostgreSQL

(node:12996) [FSTDEP022] FastifyWarning: The router options for ignoreTrailingSlash property access is deprecated. Please use "options.routerOptions" instead for accessing router options. The router options will be removed in `fastify@6`.
 [31mâ¯[39m src/test/fuzzing/auth-fuzzing.test.ts [2m([22m[2m17 tests[22m[2m | [22m[31m16 failed[39m[2m)[22m[33m 164642[2mms[22m[39m
       [33m[2mâœ“[22m[39m should handle random binary data [33m 4449[2mms[22m[39m
[31m       [31mÃ—[31m should handle extremely long strings (buffer overflow attempt)[39m[33m 10018[2mms[22m[39m
[31m       [31mÃ—[31m should handle Unicode edge cases[39m[33m 10012[2mms[22m[39m
[31m       [31mÃ—[31m should handle malformed JSON[39m[33m 10012[2mms[22m[39m
[31m       [31mÃ—[31m should handle circular JSON references[39m[33m 10009[2mms[22m[39m
[31m       [31mÃ—[31m should handle deeply nested JSON (DoS attempt)[39m[33m 10011[2mms[22m[39m
[31m       [31mÃ—[31m should handle special JavaScript values[39m[33m 10003[2mms[22m[39m
[31m       [31mÃ—[31m should handle polyglot payloads (multi-language injection)[39m[33m 10002[2mms[22m[39m
[31m       [31mÃ—[31m should handle format string attacks[39m[33m 10004[2mms[22m[39m
[31m       [31mÃ—[31m should handle negative numbers and large integers[39m[33m 10013[2mms[22m[39m
[31m       [31mÃ—[31m should handle random credentials safely[39m[33m 10009[2mms[22m[39m
[31m       [31mÃ—[31m should handle control characters in credentials[39m[33m 10007[2mms[22m[39m
[31m       [31mÃ—[31m should handle very long credentials (memory exhaustion attempt)[39m[33m 10004[2mms[22m[39m
[31m       [31mÃ—[31m should handle malformed JWT tokens[39m[33m 10012[2mms[22m[39m
[31m       [31mÃ—[31m should handle extremely long JWT tokens[39m[33m 10006[2mms[22m[39m
[31m       [31mÃ—[31m should handle malformed headers[39m[33m 10015[2mms[22m[39m
[31m       [31mÃ—[31m should handle various Content-Types safely[39m[33m 10001[2mms[22m[39m

[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m[1m[41m Failed Suites 2 [49m[22m[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m

[41m[1m FAIL [22m[49m src/test/security/api-websocket-injection-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: WebSocket Security
[31m[1mError[22m: No test found in suite ðŸ”¥ EXTREME: WebSocket Security[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[1/136]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/test/security/dos-redis-disclosure-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: Redis Security
[31m[1mError[22m: No test found in suite ðŸ”¥ EXTREME: Redis Security[39m
[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[2/136]âŽ¯[22m[39m


[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m[1m[41m Failed Tests 134 [49m[22m[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m

[41m[1m FAIL [22m[49m src/test/fuzzing/auth-fuzzing.test.ts[2m > [22mAuth Fuzzing Tests[2m > [22mRegistration Fuzzing[2m > [22mshould handle extremely long strings (buffer overflow attempt)
[41m[1m FAIL [22m[49m src/test/fuzzing/auth-fuzzing.test.ts[2m > [22mAuth Fuzzing Tests[2m > [22mRegistration Fuzzing[2m > [22mshould handle Unicode edge cases
[41m[1m FAIL [22m[49m src/test/fuzzing/auth-fuzzing.test.ts[2m > [22mAuth Fuzzing Tests[2m > [22mRegistration Fuzzing[2m > [22mshould handle malformed JSON
[41m[1m FAIL [22m[49m src/test/fuzzing/auth-fuzzing.test.ts[2m > [22mAuth Fuzzing Tests[2m > [22mRegistration Fuzzing[2m > [22mshould handle circular JSON references
[41m[1m FAIL [22m[49m src/test/fuzzing/auth-fuzzing.test.ts[2m > [22mAuth Fuzzing Tests[2m > [22mRegistration Fuzzing[2m > [22mshould handle deeply nested JSON (DoS attempt)
[41m[1m FAIL [22m[49m src/test/fuzzing/auth-fuzzing.test.ts[2m > [22mAuth Fuzzing Tests[2m > [22mRegistration Fuzzing[2m > [22mshould handle special JavaScript values
[41m[1m FAIL [22m[49m src/test/fuzzing/auth-fuzzing.test.ts[2m > [22mAuth Fuzzing Tests[2m > [22mRegistration Fuzzing[2m > [22mshould handle polyglot payloads (multi-language injection)
[41m[1m FAIL [22m[49m src/test/fuzzing/auth-fuzzing.test.ts[2m > [22mAuth Fuzzing Tests[2m > [22mRegistration Fuzzing[2m > [22mshould handle format string attacks
[41m[1m FAIL [22m[49m src/test/fuzzing/auth-fuzzing.test.ts[2m > [22mAuth Fuzzing Tests[2m > [22mRegistration Fuzzing[2m > [22mshould handle negative numbers and large integers
[41m[1m FAIL [22m[49m src/test/fuzzing/auth-fuzzing.test.ts[2m > [22mAuth Fuzzing Tests[2m > [22mLogin Fuzzing[2m > [22mshould handle random credentials safely
[41m[1m FAIL [22m[49m src/test/fuzzing/auth-fuzzing.test.ts[2m > [22mAuth Fuzzing Tests[2m > [22mLogin Fuzzing[2m > [22mshould handle control characters in credentials
[41m[1m FAIL [22m[49m src/test/fuzzing/auth-fuzzing.test.ts[2m > [22mAuth Fuzzing Tests[2m > [22mLogin Fuzzing[2m > [22mshould handle very long credentials (memory exhaustion attempt)
[41m[1m FAIL [22m[49m src/test/fuzzing/auth-fuzzing.test.ts[2m > [22mAuth Fuzzing Tests[2m > [22mJWT Fuzzing[2m > [22mshould handle malformed JWT tokens
[41m[1m FAIL [22m[49m src/test/fuzzing/auth-fuzzing.test.ts[2m > [22mAuth Fuzzing Tests[2m > [22mJWT Fuzzing[2m > [22mshould handle extremely long JWT tokens
[41m[1m FAIL [22m[49m src/test/fuzzing/auth-fuzzing.test.ts[2m > [22mAuth Fuzzing Tests[2m > [22mHTTP Header Fuzzing[2m > [22mshould handle malformed headers
[41m[1m FAIL [22m[49m src/test/fuzzing/auth-fuzzing.test.ts[2m > [22mAuth Fuzzing Tests[2m > [22mContent-Type Fuzzing[2m > [22mshould handle various Content-Types safely
[31m[1mError[22m: Hook timed out in 10000ms.
If this is a long-running hook, pass a timeout value as the last argument or configure it globally with "hookTimeout".[39m
[36m [2mâ¯[22m src/test/fuzzing/auth-fuzzing.test.ts:[2m23:3[22m[39m
    [90m 21| [39m  })[33m;[39m
    [90m 22| [39m
    [90m 23| [39m  [34mbeforeEach[39m([35masync[39m () [33m=>[39m {
    [90m   | [39m  [31m^[39m
    [90m 24| [39m    [35mawait[39m [34mclearDatabase[39m()[33m;[39m
    [90m 25| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[3/136]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/test/integration/auth.advanced.test.ts[2m > [22mAuth Advanced Security Tests[2m > [22mDevice Approval Workflow[2m > [22mshould create pending approval on first login from new device
[41m[1m FAIL [22m[49m src/test/integration/auth.advanced.test.ts[2m > [22mAuth Advanced Security Tests[2m > [22mDevice Approval Workflow[2m > [22mshould require approval from trusted device
[41m[1m FAIL [22m[49m src/test/integration/auth.advanced.test.ts[2m > [22mAuth Advanced Security Tests[2m > [22mDevice Approval Workflow[2m > [22mshould reject login from blocked device
[41m[1m FAIL [22m[49m src/test/integration/auth.advanced.test.ts[2m > [22mAuth Advanced Security Tests[2m > [22mDevice Approval Workflow[2m > [22mshould limit number of pending approvals per user
[41m[1m FAIL [22m[49m src/test/integration/auth.advanced.test.ts[2m > [22mAuth Advanced Security Tests[2m > [22mSession Management[2m > [22mshould create session on successful login
[41m[1m FAIL [22m[49m src/test/integration/auth.advanced.test.ts[2m > [22mAuth Advanced Security Tests[2m > [22mSession Management[2m > [22mshould allow multiple active sessions per user
[41m[1m FAIL [22m[49m src/test/integration/auth.advanced.test.ts[2m > [22mAuth Advanced Security Tests[2m > [22mSession Management[2m > [22mshould revoke all sessions on password change
[41m[1m FAIL [22m[49m src/test/integration/auth.advanced.test.ts[2m > [22mAuth Advanced Security Tests[2m > [22mRace Conditions & Concurrency[2m > [22mshould handle concurrent registrations of same username
[41m[1m FAIL [22m[49m src/test/integration/auth.advanced.test.ts[2m > [22mAuth Advanced Security Tests[2m > [22mRace Conditions & Concurrency[2m > [22mshould handle concurrent logins from same user
[41m[1m FAIL [22m[49m src/test/integration/auth.advanced.test.ts[2m > [22mAuth Advanced Security Tests[2m > [22mRace Conditions & Concurrency[2m > [22mshould handle concurrent requests with same JWT token
[41m[1m FAIL [22m[49m src/test/integration/auth.advanced.test.ts[2m > [22mAuth Advanced Security Tests[2m > [22mAdvanced Attack Vectors[2m > [22mshould block NoSQL injection attempts
[41m[1m FAIL [22m[49m src/test/integration/auth.advanced.test.ts[2m > [22mAuth Advanced Security Tests[2m > [22mAdvanced Attack Vectors[2m > [22mshould block LDAP injection in username
[41m[1m FAIL [22m[49m src/test/integration/auth.advanced.test.ts[2m > [22mAuth Advanced Security Tests[2m > [22mAdvanced Attack Vectors[2m > [22mshould block command injection attempts
[41m[1m FAIL [22m[49m src/test/integration/auth.advanced.test.ts[2m > [22mAuth Advanced Security Tests[2m > [22mAdvanced Attack Vectors[2m > [22mshould block path traversal in inputs
[41m[1m FAIL [22m[49m src/test/integration/auth.advanced.test.ts[2m > [22mAuth Advanced Security Tests[2m > [22mAdvanced Attack Vectors[2m > [22mshould block NULL byte injection
[41m[1m FAIL [22m[49m src/test/integration/auth.advanced.test.ts[2m > [22mAuth Advanced Security Tests[2m > [22mAdvanced Attack Vectors[2m > [22mshould block CRLF injection in headers
[41m[1m FAIL [22m[49m src/test/integration/auth.advanced.test.ts[2m > [22mAuth Advanced Security Tests[2m > [22mAdvanced Attack Vectors[2m > [22mshould not allow setting admin role through registration
[31m[1mError[22m: Hook timed out in 10000ms.
If this is a long-running hook, pass a timeout value as the last argument or configure it globally with "hookTimeout".[39m
[36m [2mâ¯[22m src/test/integration/auth.advanced.test.ts:[2m36:3[22m[39m
    [90m 34| [39m  })[33m;[39m
    [90m 35| [39m
    [90m 36| [39m  [34mbeforeEach[39m([35masync[39m () [33m=>[39m {
    [90m   | [39m  [31m^[39m
    [90m 37| [39m    [35mawait[39m [34mclearDatabase[39m()[33m;[39m
    [90m 38| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[4/136]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/test/integration/auth.test.ts[2m > [22mAuth API - Integration & Security Tests[2m > [22mPOST /api/auth/register - Registration[2m > [22mshould register new user with valid data
[31m[1mAssertionError[22m: expected 400 to be 201 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 201[39m
[31m+ 400[39m

[36m [2mâ¯[22m src/test/integration/auth.test.ts:[2m66:35[22m[39m
    [90m 64| [39m      })[33m;[39m
    [90m 65| [39m
    [90m 66| [39m      [34mexpect[39m(response[33m.[39mstatusCode)[33m.[39m[34mtoBe[39m([34m201[39m)[33m;[39m
    [90m   | [39m                                  [31m^[39m
    [90m 67| [39m
    [90m 68| [39m      [35mconst[39m body [33m=[39m [33mJSON[39m[33m.[39m[34mparse[39m(response[33m.[39mbody)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[5/136]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/test/integration/auth.test.ts[2m > [22mAuth API - Integration & Security Tests[2m > [22mPOST /api/auth/register - Registration[2m > [22mshould return JWT token with correct structure
[41m[1m FAIL [22m[49m src/test/integration/auth.test.ts[2m > [22mAuth API - Integration & Security Tests[2m > [22mPOST /api/auth/register - Registration[2m > [22mshould store auth_token in database (not plaintext password)
[41m[1m FAIL [22m[49m src/test/integration/auth.test.ts[2m > [22mAuth API - Integration & Security Tests[2m > [22mPOST /api/auth/register - Registration[2m > [22mshould reject duplicate username with 409
[41m[1m FAIL [22m[49m src/test/integration/auth.test.ts[2m > [22mAuth API - Integration & Security Tests[2m > [22mPOST /api/auth/register - Registration[2m > [22mshould reject duplicate email with 409
[41m[1m FAIL [22m[49m src/test/integration/auth.test.ts[2m > [22mAuth API - Integration & Security Tests[2m > [22mPOST /api/auth/register - Registration[2m > [22mshould reject invalid username format
[41m[1m FAIL [22m[49m src/test/integration/auth.test.ts[2m > [22mAuth API - Integration & Security Tests[2m > [22mPOST /api/auth/register - Registration[2m > [22mshould reject invalid email format
[41m[1m FAIL [22m[49m src/test/integration/auth.test.ts[2m > [22mAuth API - Integration & Security Tests[2m > [22mPOST /api/auth/register - Registration[2m > [22mshould reject short password (< 8 chars)
[41m[1m FAIL [22m[49m src/test/integration/auth.test.ts[2m > [22mAuth API - Integration & Security Tests[2m > [22mPOST /api/auth/register - Registration[2m > [22mshould reject missing fields
[41m[1m FAIL [22m[49m src/test/integration/auth.test.ts[2m > [22mAuth API - Integration & Security Tests[2m > [22mPOST /api/auth/register - Registration[2m > [22mshould block SQL injection in username
[41m[1m FAIL [22m[49m src/test/integration/auth.test.ts[2m > [22mAuth API - Integration & Security Tests[2m > [22mPOST /api/auth/register - Registration[2m > [22mshould sanitize XSS in username
[41m[1m FAIL [22m[49m src/test/integration/auth.test.ts[2m > [22mAuth API - Integration & Security Tests[2m > [22mPOST /api/auth/register - Registration[2m > [22mshould normalize email to lowercase
[41m[1m FAIL [22m[49m src/test/integration/auth.test.ts[2m > [22mAuth API - Integration & Security Tests[2m > [22mPOST /api/auth/login - Login[2m > [22mshould login with correct credentials
[41m[1m FAIL [22m[49m src/test/integration/auth.test.ts[2m > [22mAuth API - Integration & Security Tests[2m > [22mPOST /api/auth/login - Login[2m > [22mshould reject wrong password with 401
[41m[1m FAIL [22m[49m src/test/integration/auth.test.ts[2m > [22mAuth API - Integration & Security Tests[2m > [22mPOST /api/auth/login - Login[2m > [22mshould reject non-existent user with 401
[41m[1m FAIL [22m[49m src/test/integration/auth.test.ts[2m > [22mAuth API - Integration & Security Tests[2m > [22mPOST /api/auth/login - Login[2m > [22mshould take similar time for invalid username and wrong password
[41m[1m FAIL [22m[49m src/test/integration/auth.test.ts[2m > [22mAuth API - Integration & Security Tests[2m > [22mPOST /api/auth/login - Login[2m > [22mshould block SQL injection in login
[31m[1mError[22m: Hook timed out in 10000ms.
If this is a long-running hook, pass a timeout value as the last argument or configure it globally with "hookTimeout".[39m
[36m [2mâ¯[22m src/test/integration/auth.test.ts:[2m39:3[22m[39m
    [90m 37| [39m  })[33m;[39m
    [90m 38| [39m
    [90m 39| [39m  [34mbeforeEach[39m([35masync[39m () [33m=>[39m {
    [90m   | [39m  [31m^[39m
    [90m 40| [39m    [35mawait[39m [34mclearDatabase[39m()[33m;[39m
    [90m 41| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[6/136]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/test/security/api-websocket-injection-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: API Security[2m > [22mMass Assignment Vulnerability[2m > [22mshould prevent mass assignment of protected fields
[41m[1m FAIL [22m[49m src/test/security/api-websocket-injection-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: API Security[2m > [22mMass Assignment Vulnerability[2m > [22mshould whitelist only allowed fields in API requests
[41m[1m FAIL [22m[49m src/test/security/api-websocket-injection-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: API Security[2m > [22mIDOR (Insecure Direct Object Reference)[2m > [22mshould prevent accessing other users' data via ID
[41m[1m FAIL [22m[49m src/test/security/api-websocket-injection-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: API Security[2m > [22mIDOR (Insecure Direct Object Reference)[2m > [22mshould use non-sequential IDs (prevent enumeration)
[41m[1m FAIL [22m[49m src/test/security/api-websocket-injection-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: API Security[2m > [22mParameter Pollution[2m > [22mshould handle duplicate parameters safely
[41m[1m FAIL [22m[49m src/test/security/api-websocket-injection-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: API Security[2m > [22mParameter Pollution[2m > [22mshould reject conflicting parameters
[41m[1m FAIL [22m[49m src/test/security/api-websocket-injection-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: API Security[2m > [22mHTTP Verb Tampering[2m > [22mshould enforce correct HTTP methods
[41m[1m FAIL [22m[49m src/test/security/api-websocket-injection-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: API Security[2m > [22mHTTP Verb Tampering[2m > [22mshould not allow bypass via X-HTTP-Method-Override
[41m[1m FAIL [22m[49m src/test/security/api-websocket-injection-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: API Security[2m > [22mContent-Type Confusion[2m > [22mshould validate Content-Type header
[41m[1m FAIL [22m[49m src/test/security/api-websocket-injection-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: API Security[2m > [22mContent-Type Confusion[2m > [22mshould not accept XML when expecting JSON
[31m[1mError[22m: Hook timed out in 10000ms.
If this is a long-running hook, pass a timeout value as the last argument or configure it globally with "hookTimeout".[39m
[36m [2mâ¯[22m src/test/security/api-websocket-injection-extreme.test.ts:[2m65:3[22m[39m
    [90m 63| [39m  })[33m;[39m
    [90m 64| [39m
    [90m 65| [39m  [34mbeforeEach[39m([35masync[39m () [33m=>[39m {
    [90m   | [39m  [31m^[39m
    [90m 66| [39m    [35mawait[39m [34mclearDatabase[39m()[33m;[39m
    [90m 67| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[7/136]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/test/security/api-websocket-injection-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: XSS (Cross-Site Scripting)[2m > [22mReflected XSS[2m > [22mshould sanitize XSS in username field
[41m[1m FAIL [22m[49m src/test/security/api-websocket-injection-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: XSS (Cross-Site Scripting)[2m > [22mReflected XSS[2m > [22mshould sanitize XSS in search queries
[41m[1m FAIL [22m[49m src/test/security/api-websocket-injection-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: XSS (Cross-Site Scripting)[2m > [22mMutation XSS[2m > [22mshould prevent mXSS via HTML mutation
[31m[1mError[22m: Hook timed out in 10000ms.
If this is a long-running hook, pass a timeout value as the last argument or configure it globally with "hookTimeout".[39m
[36m [2mâ¯[22m src/test/security/api-websocket-injection-extreme.test.ts:[2m304:3[22m[39m
    [90m302| [39m  })[33m;[39m
    [90m303| [39m
    [90m304| [39m  [34mbeforeEach[39m([35masync[39m () [33m=>[39m {
    [90m   | [39m  [31m^[39m
    [90m305| [39m    [35mawait[39m [34mclearDatabase[39m()[33m;[39m
    [90m306| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[8/136]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/test/security/api-websocket-injection-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: Command & Path Injection[2m > [22mOS Command Injection[2m > [22mshould block command injection in username
[41m[1m FAIL [22m[49m src/test/security/api-websocket-injection-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: Command & Path Injection[2m > [22mOS Command Injection[2m > [22mshould not execute commands from user input
[41m[1m FAIL [22m[49m src/test/security/api-websocket-injection-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: Command & Path Injection[2m > [22mPath Traversal[2m > [22mshould block path traversal in filenames
[41m[1m FAIL [22m[49m src/test/security/api-websocket-injection-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: Command & Path Injection[2m > [22mPath Traversal[2m > [22mshould not expose .env or config files
[31m[1mError[22m: Hook timed out in 10000ms.
If this is a long-running hook, pass a timeout value as the last argument or configure it globally with "hookTimeout".[39m
[36m [2mâ¯[22m src/test/security/api-websocket-injection-extreme.test.ts:[2m418:3[22m[39m
    [90m416| [39m  })[33m;[39m
    [90m417| [39m
    [90m418| [39m  [34mbeforeEach[39m([35masync[39m () [33m=>[39m {
    [90m   | [39m  [31m^[39m
    [90m419| [39m    [35mawait[39m [34mclearDatabase[39m()[33m;[39m
    [90m420| [39m  })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[9/136]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/test/security/auth-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: Authentication & Session Security[2m > [22mJWT Manipulation & Bypass[2m > [22mshould reject JWT with tampered signature
[41m[1m FAIL [22m[49m src/test/security/auth-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: Authentication & Session Security[2m > [22mJWT Manipulation & Bypass[2m > [22mshould reject JWT with tampered payload
[41m[1m FAIL [22m[49m src/test/security/auth-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: Authentication & Session Security[2m > [22mJWT Manipulation & Bypass[2m > [22mshould reject JWT with weak/guessable secret
[41m[1m FAIL [22m[49m src/test/security/auth-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: Authentication & Session Security[2m > [22mJWT Manipulation & Bypass[2m > [22mshould reject expired JWT tokens
[41m[1m FAIL [22m[49m src/test/security/auth-extreme.test.ts[2m > [22mðŸ”¥ EXTREME: Authentication & Session Security[2m > [22mJWT Manipulation & Bypass[2m > [22mshould reject JWT with future 'nbf' (not before) claim
â€‰ELIFECYCLEâ€‰ Test failed. See above for more details.
